  ## Freelog后端整体架构

        Freelog目前整体后端架构基于微服务实现,框架使用基于koa2的eggJs搭建.然后独立封装飞致基础插件freelog-egg-base和freelog-egg-database.
    所有基于eggJs的微服务项目直接引入插件,即可统一全局的调用插件内部功能.
    其中freelog-egg-base封装了项目常用的拓展,包括API接口统一格式包装,统一错误处理,统一的格式校验.以及各种针对性的拓展函数.还包括了正常请求
    所需要的egg中间件,以及跨服务之间的请求URL统一管理,数据加密与错误处理等功能.freelog-egg-database插件主要用于针对数据库的操作封装.包含了
    单条查询,批量查询,分页查询,排序,写入,批量写入等各种DB操作.目前主要支出mongodb和mysql.后续有其他DB的操作需求,直接继承基类,实现对应的函数即可.

        对外提供的API统一使用restful形式提供.
    目前总共包括网关,身份服务,资源服务,节点服务,授权服务,支付服务,事件服务,统计服务以及节点的WEB渲染9个服务.
    各服务内部通讯使用http-restful形式统一经过网关来处理.网关服务会进行基于oauth-client模式的认证和授权.然后路由到具体的服务,
    每次跨服务请求都会带上具体的客户端keyId以及实际请求的用户身份信息等加密内容.
        Freelog后端目前各服务都是使用的mongodb作为数据存储.后续可以根据不同服务的具体业务自行选择.不做限制. 消息队列目前使用rabbit.

   ### 身份服务

        身份服务目前主要提供用户注册,登录,内测审核,发送验证信息,用户分组以及对外提供用户相关信息API等功能.
   该服务单点登录是基于JWT实现的,支持同主域名下的所有站点.JWT加密算法目前是基于RSA-SHA256实现.
   Email发送目前使用的nodemailer模块,然后调用阿里云的电子邮件发送服务.短信发送使用@alicloud/sms-sdk模块,然后调用阿里云短信服务.
   具体的配置与限制可以通过阿里云平台具体设置.身份服务目前没有跨服务调用需求.

   ### 资源服务
   资源服务目前共分为mock资源,资源,发行,收藏共4个模块.业务正常流程是用户先创建mock资源作为测试使用,然后测试完成,转换成正式资源.然后加入到发行中.
   项目中资源文件操作专门抽象出了接口基类.目前只实现了阿里云OSS的具体代码,后续也可以根据实现亚马逊S3.



